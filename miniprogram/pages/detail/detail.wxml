<!-- é¥°å“è¯¦æƒ…é¡µ -->
<view class="detail-page">
  <!-- åŠ è½½ä¸­ -->
  <view class="loading" wx:if="{{loading}}">
    <text class="loading-text">åŠ è½½ä¸­...</text>
  </view>

  <!-- è¯¦æƒ…å†…å®¹ -->
  <block wx:if="{{!loading && goodsDetail}}">
    <!-- å•†å“åŸºç¡€ä¿¡æ¯ -->
    <view class="goods-header">
      <image class="goods-image" src="{{goodsDetail.iconUrl}}" mode="aspectFit"></image>
      <view class="goods-info">
        <text class="goods-name">{{goodsDetail.name}}</text>
        <view class="goods-meta">
          <view class="meta-item">
            <text class="meta-label">å“è´¨ | </text>
            <text class="meta-value rarity" style="color: {{goodsDetail.rarityColor || '#333'}}">{{goodsDetail.rarityName || '-'}}</text>
          </view>
          <view class="meta-item">
            <text class="meta-label">ç±»åˆ« | </text>
            <text class="meta-value">{{goodsDetail.qualityName || '-'}}</text>
          </view>
        </view>
      </view>
    </view>

    <!-- ä»·æ ¼æ¶¨å¹… -->
    <view class="price-change-card" wx:if="{{goodsDetail.priceChange && goodsDetail.priceChange.length > 0}}">
      <view class="card-title">ä»·æ ¼æ¶¨å¹…</view>
      <scroll-view class="price-change-scroll" scroll-x enable-flex>
        <view class="price-change-list">
          <view 
            class="price-change-item {{item.isUp ? 'is-up' : ''}}" 
            wx:for="{{goodsDetail.priceChange}}" 
            wx:key="label"
          >
            <view class="change-label">
              <text>{{item.label}}</text>
              <text class="change-icon {{item.isUp ? 'icon-up' : 'icon-down'}}">{{item.isUp ? 'â–²' : 'â–¼'}}</text>
            </view>
            <view class="change-value {{item.isUp ? 'text-red' : 'text-green'}}">
              <text class="price-diff">Â¥{{item.priceDiffText}}</text>
              <text class="change-rate">({{item.changeRateText}})</text>
            </view>
          </view>
        </view>
      </scroll-view>
    </view>

    <!-- å¸‚åœºå¯¹æ¯” -->
    <view class="market-card">
      <view class="card-title">å¸‚åœºå¯¹æ¯”</view>
      <view class="market-list">
        <view 
          class="market-item" 
          wx:for="{{goodsDetail.platformList}}" 
          wx:key="platform"
          data-link="{{item.link}}"
          bindtap="openPlatformLink"
        >
          <view class="market-header">
            <view class="platform-info">
              <image class="platform-icon" src="{{item.icon}}" mode="aspectFit"></image>
              <text class="platform-name">{{item.platformName}}</text>
            </view>
          </view>
          <view class="market-price">
            <text class="price-value">Â¥{{item.sellPriceText}}</text>
            <view class="lowest-badge" wx:if="{{item.isLowest}}">åº•</view>
          </view>
          <view class="market-footer">
            <view class="market-stats">
              <view class="stat-item">
                <text class="stat-label">åœ¨å”®</text>
                <text class="stat-value">{{item.sellCount}}</text>
              </view>
              <view class="stat-item">
                <text class="stat-label">æ±‚è´­</text>
                <text class="stat-value bid">Â¥{{item.biddingPriceText}}</text>
              </view>
            </view>
            <text class="update-time">{{item.updateTimeText}}</text>
          </view>
        </view>
      </view>
    </view>

    <!-- å½“å‰åœ¨å”®è¡¨æ ¼ -->
    <view class="onsale-card">
      <view class="card-title">å½“å‰åœ¨å”®</view>
      <view class="onsale-table">
        <view class="table-header">
          <text class="col-source">æ¥æº</text>
          <text class="col-price">å”®ä»·</text>
          <text class="col-bid">æ±‚è´­ä»·</text>
          <text class="col-count">åœ¨å”®</text>
        </view>
        <view 
          class="table-row" 
          wx:for="{{goodsDetail.platformList}}" 
          wx:key="platform"
          data-link="{{item.link}}"
          bindtap="openPlatformLink"
        >
          <view class="col-source">
            <image class="platform-icon-small" src="{{item.icon}}" mode="aspectFit"></image>
            <text class="platform-name-small">{{item.platformName}}</text>
          </view>
          <text class="col-price text-orange">Â¥{{item.sellPriceText}}</text>
          <text class="col-bid text-orange">Â¥{{item.biddingPriceText}}</text>
          <text class="col-count">{{item.sellCount}}ä»¶</text>
        </view>
      </view>
    </view>

    <!-- æç¤º -->
    <view class="tip-card">
      <text class="tip-text">ğŸ’¡ ç‚¹å‡»å¹³å°å¡ç‰‡å¯å¤åˆ¶è´­ä¹°é“¾æ¥</text>
    </view>
  </block>

  <!-- ç©ºçŠ¶æ€ -->
  <view class="empty" wx:if="{{!loading && !goodsDetail}}">
    <text class="empty-icon">ğŸ“¦</text>
    <text class="empty-text">æš‚æ— æ•°æ®</text>
  </view>
</view>
