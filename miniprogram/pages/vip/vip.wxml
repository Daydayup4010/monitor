<!-- VIP开通页面 -->
<view class="vip-page">
  <!-- VIP头部卡片 -->
  <view class="vip-header-card">
    <view class="vip-header-left">
      <image class="vip-icon" src="/images/vip.png"></image>
      <text class="vip-title">VIP会员</text>
    </view>
    <view class="vip-header-right">
      <text class="vip-price-label">¥</text>
      <text class="vip-price-value">{{lowestPrice}}</text>
      <text class="vip-price-unit">/月起</text>
    </view>
  </view>

  <!-- 当前VIP状态 -->
  <view class="vip-status" wx:if="{{userInfo && userInfo.role === 1}}">
    <text class="status-label">当前状态：</text>
    <text class="status-value vip">VIP会员</text>
    <text class="status-expiry" wx:if="{{userInfo.vip_expiry}}">（到期：{{formatExpiry}}）</text>
  </view>

  <!-- VIP特权说明 -->
  <view class="privileges-card">
    <view class="card-title">VIP特权</view>
    
    <view class="feature-group">
      <view class="feature-item">
        <view class="feature-check">✓</view>
        <text class="feature-text">查看饰品历史价格走势</text>
      </view>
      <view class="feature-item">
        <view class="feature-check">✓</view>
        <text class="feature-text">查看各大平台实时价格对比</text>
      </view>
      <view class="feature-item">
        <view class="feature-check">✓</view>
        <text class="feature-text">查看饰品历史涨跌榜单</text>
      </view>
    </view>

    <view class="feature-divider"></view>

    <view class="feature-group">
      <view class="feature-item">
        <view class="feature-check">✓</view>
        <text class="feature-text">搬砖比价功能使用特权</text>
      </view>
      <view class="feature-item">
        <view class="feature-check">✓</view>
        <text class="feature-text">挂刀比价功能使用特权</text>
      </view>
      <view class="feature-item">
        <view class="feature-check">✓</view>
        <text class="feature-text">大件求购功能使用特权</text>
      </view>
    </view>

    <view class="feature-divider"></view>

    <view class="feature-group">
      <view class="feature-item">
        <view class="feature-check">✓</view>
        <text class="feature-text">尊贵VIP会员身份标识</text>
      </view>
      <view class="feature-item">
        <view class="feature-check">✓</view>
        <text class="feature-text">优先获得新功能体验资格</text>
      </view>
    </view>
  </view>

  <!-- 套餐选择 -->
  <view class="plans-card">
    <view class="card-title">选择套餐</view>
    <view class="plans-list" wx:if="{{!loading && plans.length > 0}}">
      <view 
        class="plan-item {{selectedPlan && selectedPlan.months === item.months ? 'selected' : ''}} {{item.recommend ? 'recommend' : ''}}"
        wx:for="{{plans}}"
        wx:key="months"
        data-months="{{item.months}}"
        bindtap="selectPlan"
      >
        <view class="plan-badge" wx:if="{{item.recommend}}">推荐</view>
        <view class="plan-months">{{item.months}}个月</view>
        <view class="plan-price">
          <text class="price-symbol">¥</text>
          <text class="price-value">{{item.price}}</text>
        </view>
        <view class="plan-unit">¥{{item.pricePerMonth}}/月</view>
      </view>
    </view>
    <view class="loading-plans" wx:if="{{loading}}">
      <text>加载中...</text>
    </view>
  </view>

  <!-- 已选信息 -->
  <view class="selected-info" wx:if="{{selectedPlan}}">
    <text class="selected-label">已选择：{{selectedPlan.months}}个月</text>
    <text class="selected-price">合计：<text class="price-highlight">¥{{selectedPlan.price}}</text></text>
  </view>

  <!-- 支付按钮 -->
  <view class="pay-section">
    <button 
      class="pay-btn" 
      bindtap="handlePay"
      disabled="{{paying || !selectedPlan}}"
    >
      {{paying ? '支付中...' : (userInfo && userInfo.role === 1 ? '续费会员' : '立即开通')}}
    </button>
  </view>

  <!-- 底部说明 -->
  <view class="footer-tips">
    <text class="tip-text">• 小程序目前仅提供搬砖比价功能, 其他功能请使用电脑访问网站www.csgoods.com.cn</text>
    <text class="tip-text">• 如有问题请联系客服</text>
  </view>
</view>
